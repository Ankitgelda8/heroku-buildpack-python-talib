#!/usr/bin/env bash

echo "Installing TA-Lib C library..."

# Step 1: Download and extract TA-Lib source
wget http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz
tar -xf ta-lib-0.4.0-src.tar.gz
cd ta-lib

# Step 2: Configure and install TA-Lib
./configure --prefix=/app/.heroku
make
make install
cd ..

# Step 3: Clean up
rm -rf ta-lib ta-lib-0.4.0-src.tar.gz

# Step 4: Install Python wrapper
echo "Installing TA-Lib Python wrapper..."
CFLAGS="-I/app/.heroku/include" LDFLAGS="-L/app/.heroku/lib" /app/.heroku/python/bin/pip install TA-Lib==0.4.24
